! ZouariOmar <zouariomar20@gmail.com>
! Since:         2025-11-19
! LastUpdate:    2025-11-24
! RouterVersion: C3745
! COPY-THAN-PASTE

conf t
hostname R-nfs

! ============================
! ===== INTERFACES PART ======
! F0/1(OUTSIDE) - F0/0(INSIDE)
! ============================

! FastEthernet0/1 (outside)
interface fa0/1
  description R-nfs to UDP Tunnel
  ip address 10.0.0.2 255.255.255.0
  no shutdown
  exit

! FastEthernet0/0 (inside)
interface fa0/0
  description R-nfs to SW1
  ip address 172.24.74.1 255.255.255.0
  no shutdown
  exit

! ============================
! ====== SERVICES PART =======
! NAT(D/S) - OSPF - DHCP - DNS
! ============================

! NAT configuration
! ip nat inside source static tcp 172.24.74.2 22 X.X.X.X 22
! ip nat inside source static tcp 172.24.74.2 80 X.X.X.X 80
! Interfaces
interface fa0/1
  ip nat outside
  exit
interface fa0/0
  ip nat inside
  exit

! ACL for dynamic NAT
access-list 1 permit 172.24.74.0 0.0.0.255

! Dynamic NAT / PAT for other hosts
ip nat inside source list 1 interface fa0/1 overload

! Static NAT for server
ip nat inside source static 172.24.74.2 10.0.0.3
! ip nat inside source static tcp 172.24.74.2 22 X.X.X.X 22
! ip nat inside source static tcp 172.24.74.2 80 X.X.X.X 80

! OSPF
router ospf 0
  network 10.0.0.0 0.0.0.255 area 0
  exit

! DHCP
ip dhcp pool NFS-DHCP
  network 172.24.74.0 255.255.255.0
  default-router 172.24.74.1
  dns-server 8.8.8.8
  exit
ip dhcp excluded-address 172.24.74.1
ip dhcp excluded-address 172.24.74.2
ip dhcp excluded-address 172.24.74.255

! DNS
ip domain-lookup
  ip name-server 8.8.8.8
  exit


! ============================
! ====== SECURITY PART =======
! CONSOLE - SSH - TELNET - ACL
! ============================

! Create an Admin user
username admin privilege 15 secret <STRONG_PASSWORD>

! Console
line console 0
  login local
  exec-timeout 5 0    ! Auto-logout after 5min
  logging synchronous ! Clean console display
  exit

! SSH
crypto key generate rsa usage-keys label SSH modulus 2048
ip ssh version 2
! ip access-list standard SSH_ONLY
!   permit X.X.X.X X.X.X.X
!   deny any
line vty 0 4
  login local
  transport input ssh
! access-class SSH_ONLY in
  exec-timeout 5 0
  logging synchronous
  exit

! Telnet
! ip access-list standard TELNET_ONLY
!   permit 10.0.0.0 0.0.0.255
!   deny any
line vty 5 15
  login local
  transport input telnet
! access-class TELNET_ONLY in
  exec-timeout 5 0
  logging synchronous
  end

! Encrypt all passwords
service password-encryption

! Disable unused services
! no ip http server          ! HTTP
! no ip http secure-server   ! HTTPS
! no cdp run                 ! CDP

write

! =========================
! === VERIFICATION PART ===
! =========================

! Verify NAT configuration
show ip nat translations

